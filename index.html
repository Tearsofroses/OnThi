<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive MCQ Quiz</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <link rel="stylesheet" href="styles.css?v=1.0.0">
    <!-- Google reCAPTCHA v3 -->
    <script src="https://www.google.com/recaptcha/api.js?render=6LfFVyksAAAAAHRZbip60OZY6h19WSAwrKojXlf5"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>Interactive MCQ Quiz</h1>
        </header>

        <!-- Input Section -->
        <div id="input-section" class="section">
            <h2>Setup Your Quiz</h2>
            
            <!-- Saved Quizzes -->
            <div id="saved-quizzes-section" class="saved-quizzes">
                <h3>üìÅ My Saved Quizzes</h3>
                <div id="saved-quizzes-list" class="quiz-list">
                    <p class="no-quizzes">No saved quizzes yet</p>
                </div>
            </div>

            <!-- Shared Quizzes -->
            <div id="shared-quizzes-section" class="saved-quizzes shared-section">
                <div class="section-header">
                    <h3>üåê Community Shared Quizzes</h3>
                    <button id="refresh-shared-btn" class="btn btn-small btn-secondary">üîÑ Refresh</button>
                </div>
                <div id="shared-quizzes-list" class="quiz-list">
                    <p class="no-quizzes">Loading community quizzes...</p>
                </div>
                <p class="share-info">üí° Click "üì§ Share to Community" to publish your quiz for everyone!<br>
                <small style="color: #666;">Other users need to click üîÑ Refresh to see new quizzes</small></p>
            </div>
            
            <div class="format-guide">
                <h3>Expected Format:</h3>
                <div class="format-example">
                    <strong>Questions:</strong>
                    <pre>1. (LO 1.1) Which of the following best describes the "Three-Schema Architecture"?

A. It separates the database into three physical files for redundancy.

B. It separates the user applications from the physical database to achieve data independence.

C. It divides users into three levels: Administrator, Designer, and End User.

D. It is a backup strategy involving three copies of data.

2. (LO 1.2) In the Relational Data Model, what is a "Relation" conceptually equivalent to?

A. A row in a file.

B. A pointer connecting two records.

C. A mathematical table of values using $R(X, Y, Z)$ notation.

D. A hierarchy of objects.</pre>
                    
                    <strong>Answer Key (at the end):</strong>
                    <pre>1B2C3A4B5C...</pre>
                    <p class="format-note"><strong>Note:</strong> LaTeX math notation like $\pi$, $\sigma$, $R(X,Y)$ is supported!</p>
                </div>
            </div>
            
            <p>Paste your MCQ questions and answer key below:</p>
            <div class="quiz-name-section">
                <label for="quiz-name-input">Quiz Name (optional):</label>
                <input type="text" id="quiz-name-input" placeholder="e.g., Database Management Final Exam" maxlength="100">
            </div>
            <textarea id="quiz-input" placeholder="Paste your questions here..."></textarea>
            
            <div class="input-actions">
                <button id="start-quiz-btn" class="btn btn-primary">Start Quiz</button>
                <button id="save-quiz-btn" class="btn btn-secondary">Save Quiz</button>
                <button id="publish-quiz-btn" class="btn btn-success">üì§ Share to Community</button>
                <button id="export-all-btn" class="btn btn-secondary">Export All Quizzes</button>
                <label for="import-file" class="btn btn-secondary">
                    Import Quizzes
                    <input type="file" id="import-file" accept=".json" style="display: none;">
                </label>
            </div>
        </div>

        <!-- Quiz Section -->
        <div id="quiz-section" class="section hidden quiz-with-chat">
            <div class="quiz-main-content">
                <div class="quiz-header">
                    <div class="progress-bar">
                        <div id="progress" class="progress-fill"></div>
                    </div>
                    <p class="question-counter">Question <span id="current-q">1</span> of <span id="total-q">0</span></p>
                </div>
            
            <div id="question-container">
                <h3 id="question-text"></h3>
                <div id="options-container" class="options"></div>
            </div>

            <div class="quiz-controls">
                <button id="prev-btn" class="btn btn-secondary" disabled>Previous</button>
                <button id="next-btn" class="btn btn-primary">Next</button>
                <button id="submit-btn" class="btn btn-success hidden">Submit Quiz</button>
            </div>
            </div>

            <!-- AI Chat Sidebar -->
            <div id="ai-chat-sidebar" class="ai-chat-sidebar">
                <div class="chat-header">
                    <h3>üí¨ AI Study Helper</h3>
                    <button id="chat-toggle-btn" class="chat-toggle-btn">√ó</button>
                </div>
                <div id="chat-status" class="chat-status">
                    ‚öôÔ∏è Configure AI in settings to get help
                </div>
                <div id="chat-messages" class="chat-messages">
                    <div class="chat-message system">
                        üëã Hi! I'm your AI study assistant. Ask me anything about the current question!
                    </div>
                </div>
                <div class="chat-quick-actions">
                    <button class="quick-action-btn" data-action="explain">üí° Explain</button>
                    <button class="quick-action-btn" data-action="hint">üéØ Give Hint</button>
                    <button class="quick-action-btn" data-action="breakdown">üîç Break Down</button>
                    <button class="quick-action-btn" data-action="topic">üìñ Topic</button>
                </div>
                <div class="chat-input-area">
                    <div class="chat-input-group">
                        <textarea id="chat-input" class="chat-input" placeholder="Ask a question..." rows="2"></textarea>
                        <button id="chat-send-btn" class="chat-send-btn">Send</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- AI Settings Modal -->
        <div id="ai-settings-modal" class="modal-overlay hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>ü§ñ AI Assistant Settings</h2>
                    <div class="security-warning">
                        <strong>üîí Security:</strong> Your API key is stored only in your browser's session (cleared when you close the browser). It is NEVER sent to our servers and only goes directly to your chosen AI provider.
                    </div>
                </div>
                <div class="form-group">
                    <label for="ai-provider-select">Choose AI Provider:</label>
                    <select id="ai-provider-select">
                        <option value="">-- Select Provider --</option>
                        <option value="openai">OpenAI (ChatGPT)</option>
                        <option value="gemini">Google Gemini</option>
                        <option value="groq">Groq (Free)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="ai-model-select">Choose Model:</label>
                    <select id="ai-model-select" disabled>
                        <option value="">-- Select provider first --</option>
                    </select>
                    <small style="color: #666; margin-top: 5px; display: block;">
                        üí° Tip: gpt-4o-mini and Gemini Flash are the cheapest/free options
                    </small>
                </div>
                <div class="form-group">
                    <label for="ai-api-key-input">API Key:</label>
                    <input type="password" id="ai-api-key-input" class="api-key-input" placeholder="Paste your API key here...">
                    <small style="color: #666; margin-top: 5px; display: block;">
                        Get your free API key from:
                        <a href="https://platform.openai.com/api-keys" target="_blank">OpenAI</a> |
                        <a href="https://makersuite.google.com/app/apikey" target="_blank">Gemini</a> |
                        <a href="https://console.groq.com/keys" target="_blank">Groq</a>
                    </small>
                </div>
                <div class="modal-actions">
                    <button id="ai-settings-clear-btn" class="btn btn-danger">Clear</button>
                    <button id="ai-settings-cancel-btn" class="btn btn-secondary">Cancel</button>
                    <button id="ai-settings-save-btn" class="btn btn-primary">Save</button>
                </div>
            </div>
        </div>

        <!-- AI Settings Button (Floating) -->
        <button id="ai-settings-btn" class="ai-settings-btn">ü§ñ AI Settings</button>

        <!-- Results Section -->
        <div id="results-section" class="section hidden">
            <h2>Quiz Results</h2>
            <div class="score-summary">
                <div class="score-circle">
                    <span id="score-percentage">0%</span>
                </div>
                <p class="score-text">You scored <span id="score">0</span> out of <span id="total">0</span></p>
            </div>
            
            <h3>Review Your Answers</h3>
            <div id="review-container"></div>
            
            <div class="result-actions">
                <button id="restart-btn" class="btn btn-primary">Take New Quiz</button>
            </div>
        </div>
    </div>

    <!-- External Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    
    <!-- MVC Architecture -->
    <script src="ai-helper.js?v=1.0.6"></script>
    <script src="models.js?v=1.0.2"></script>
    <script src="views.js?v=1.0.3"></script>
    <script src="controllers.js?v=1.0.3"></script>
    <script src="app.js?v=1.0.2"></script>
</body>
</html>
